
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Programs &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CCP4i2 Tutorial: Glyco (PDB:4IID)" href="../../tutorials/glyco/README.html" />
    <link rel="prev" title="CCP4i2 MR Tutorial: Preparing AlphaFold/RoseTTAFold search models for MR. (Gamma example)" href="../../tutorials/alphafold/alphafold_tutorial.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#roadshow/mdm2/LigandTutorial" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Programs </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
          <li class="md-tabs__item"><a href="../../tutorials/index.html" class="md-tabs__link">Introduction to CC4i2</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#roadshow-mdm2-ligandtutorial--page-root" class="md-nav__link">Programs</a>
        </li>
        <li class="md-nav__item"><a href="#scenario" class="md-nav__link">Scenario</a>
        </li>
        <li class="md-nav__item"><a href="#task-1-get-the-data" class="md-nav__link">Task 1: Get the data</a>
        </li>
        <li class="md-nav__item"><a href="#task-2-make-your-ligand-make-ligand-task-lidia-acedrg-rdkit" class="md-nav__link">Task 2: Make your ligand – Make ligand task (LIDIA, ACEDRG, RDKIT)</a>
        </li>
        <li class="md-nav__item"><a href="#task-3-generate-a-starting-model-molecular-replacement-phaser" class="md-nav__link">Task 3: Generate a starting model (Molecular replacement: PHASER)</a>
        </li>
        <li class="md-nav__item"><a href="#task-4-refine-the-starting-model-to-create-difference-density-for-the-ligand-refinement-refmac5" class="md-nav__link">Task 4: Refine the starting model to create difference density for the ligand (Refinement: REFMAC5)</a>
        </li>
        <li class="md-nav__item"><a href="#task-5-generate-a-starting-model-manual-model-building-coot-refinement-refmac5" class="md-nav__link">Task 5: Generate a starting model (Manual model building: COOT, Refinement – REFMAC5)</a>
        </li>
        <li class="md-nav__item"><a href="#task-6-introduce-your-ligand-into-the-structure-manual-model-building-coot" class="md-nav__link">Task 6: Introduce your ligand into the structure (Manual model building: COOT)</a>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/roadshow/mdm2/LigandTutorial.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="programs">
<h1 id="roadshow-mdm2-ligandtutorial--page-root">Programs<a class="headerlink" href="#roadshow-mdm2-ligandtutorial--page-root" title="Permalink to this heading">¶</a></h1>
<p>ACEDRG, PHASER, REFMAC, RDKIT, COOT</p>
</section>
<section id="scenario">
<h1 id="scenario">Scenario<a class="headerlink" href="#scenario" title="Permalink to this heading">¶</a></h1>
<p>(Accurately) informed that there is “a lot of rubbish” among the
structure ligand complexes in the PDB, you decide to re-solve the
structure of everyone’s favourite PPI drug target MDM2 in complex with
the game-changing tool compound Nutlin 3A. There is a dodgy 1.6 Å
structure (PDB: 4hg7) deposited by a disreputable group….so you plan to
use their deposited reflections, but start from someone else’s model
There is a nice MDM2 structure from another group (4qo4) that you choose
for your startpoint. You plan to use modern tools to make a start model
for Nutlin 3A. The other model is of a longer construct and you will
only use residues 20-107 of Chain A.</p>
</section>
<section id="task-1-get-the-data">
<h1 id="task-1-get-the-data">Task 1: Get the data<a class="headerlink" href="#task-1-get-the-data" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>Open CCP4i2 and make a new project called MDM2</p></li>
<li><p>“Utilities” -&gt; “Copy demo data to project” -&gt; “MDM2”</p></li>
<li><p>Click the “Task menu” button in CCP4i2.</p></li>
<li><p>Expand the Import merged data, AU contents, alignments or coordinates
section.</p></li>
<li><p>Create a new Import merged reflection data task</p></li>
<li><p>You can import files (reflections or coordinates) from the PDB
directly: in the file browser dialog (accessed by clicking ): a line
at the top allows you to provide the accession code (4hg7). <a class="reference internal" href="../../_images/LigandTutorial-mdm2-1.png"><img alt="Download Coordinates" src="../../_images/LigandTutorial-mdm2-1.png" style="height: 60px;"/></a></p></li>
<li><p>Click “Download” then once the file has downloaded “Open” and click
“OK” on the file provenance pop-up.</p></li>
<li><p>Enter a name for “Crystal” and “Dataset”</p></li>
<li><p>Click “Run”</p></li>
<li><p>You’ll see a nice report about the quality of the data which should
hopefully look familiar. The data from the original file are kept -
the report is for analysis only.</p></li>
</ol>
</section>
<section id="task-2-make-your-ligand-make-ligand-task-lidia-acedrg-rdkit">
<h1 id="task-2-make-your-ligand-make-ligand-task-lidia-acedrg-rdkit">Task 2: Make your ligand – Make ligand task (LIDIA, ACEDRG, RDKIT)<a class="headerlink" href="#task-2-make-your-ligand-make-ligand-task-lidia-acedrg-rdkit" title="Permalink to this heading">¶</a></h1>
<p><a class="reference internal" href="../../_images/LigandTutorial-mdm2-2.png"><img alt="Make Ligand" src="../../_images/LigandTutorial-mdm2-2.png" style="height: 300px;"/></a></p>
<ol class="arabic simple">
<li><p>This takes a while to run so it’s best to do it next. Click the “Task
menu” button in CCP4i2.</p></li>
<li><p>Expand the Ligands section.</p></li>
<li><p>Create a new Make Ligand – Acedrg job.</p></li>
<li><p>The fastest option is to change “Start with molecular structure from”
in the “Start point” subsection to “a SMILES string:
COc1ccc(c(OC(C)C)c1)C2=N[C@H]([C@H](N2C(=O)N3CCNC(=O)C3)c4ccc(Cl)cc4)c5ccc(Cl)cc5</p></li>
<li><p>Perhaps change “Three letter code for output monomer” to something
more informative?</p></li>
<li><p>Click “Run”</p></li>
</ol>
<div class="line-block">
<div class="line">HINT: The structural formula of Nutlin 3A is:</div>
<div class="line"><a class="reference internal" href="../../_images/LigandTutorial-mdm2-3.png"><img alt="Nutlin Ligand" src="../../_images/LigandTutorial-mdm2-3.png" style="height: 200px;"/></a></div>
</div>
</section>
<section id="task-3-generate-a-starting-model-molecular-replacement-phaser">
<h1 id="task-3-generate-a-starting-model-molecular-replacement-phaser">Task 3: Generate a starting model (Molecular replacement: PHASER)<a class="headerlink" href="#task-3-generate-a-starting-model-molecular-replacement-phaser" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>Whilst waiting move on to molecular replacement. First we need to
define the contents of the asymmetric unit. Click the “Task menu”
button in the toolbar.</p></li>
<li><p>Expand the Import merged data, AU contents, alignments or coordinates
section.</p></li>
<li><p>Create a new Define AU contents job.</p></li>
<li><p>Click “Browse for sequence file” and load “4hg7.seq” from the “mdm2”
folder.</p></li>
<li><p>Click “Run”</p></li>
<li><p>Click the “Task menu” button in CCP4i2.</p></li>
<li><p>Expand the Molecular replacement section.</p></li>
<li><p>Create a new Basic Molecular Replacement – PHASER job.</p></li>
<li><p>The reflection data will be automatically filled in but we need to
change “Composition of the asymmetric unit” in the “Composition”
subsection to “Provided as full specification by sequence” which
should select the output of the Define AU contents job automatically.</p></li>
<li><p>For the search model download the coordinates from the PDB directly:
in the file browser dialog (accessed by clicking ): a line at the top
allows you to provide the accession code (4qo4).</p></li>
<li><p>This is the structure of a longer construct so we need to select only
residues 20-107.</p></li>
<li><p>Right click the icon left of “Search” in the “Search model”
subsection and choose “Select atoms” Provide the selection string
“A/20-107” (quotation marks should not be included).</p></li>
<li><p>Click “Run”</p></li>
<li><p>Does the report indicate molecular replacement has been successful?
What is the LLG and TF Z-score?</p></li>
</ol>
</section>
<section id="task-4-refine-the-starting-model-to-create-difference-density-for-the-ligand-refinement-refmac5">
<h1 id="task-4-refine-the-starting-model-to-create-difference-density-for-the-ligand-refinement-refmac5">Task 4: Refine the starting model to create difference density for the ligand (Refinement: REFMAC5)<a class="headerlink" href="#task-4-refine-the-starting-model-to-create-difference-density-for-the-ligand-refinement-refmac5" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>Click the “REFMAC5” button at the bottom of the report</p></li>
<li><p>This will create a new Refinement – REFMAC5 job with the coordinates
from the previous Molecular replacement job already selected.</p></li>
<li><p>Change “Number of refinement cycles” in the “Options” subsection to
20.</p></li>
<li><p>Click “Run”</p></li>
</ol>
</section>
<section id="task-5-generate-a-starting-model-manual-model-building-coot-refinement-refmac5">
<h1 id="task-5-generate-a-starting-model-manual-model-building-coot-refinement-refmac5">Task 5: Generate a starting model (Manual model building: COOT, Refinement – REFMAC5)<a class="headerlink" href="#task-5-generate-a-starting-model-manual-model-building-coot-refinement-refmac5" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>After 20 cycles R/Rfree should be ~0.35/0.37. Click the “COOT” button
at the bottom of the report.</p></li>
<li><p>This will create a new Manual model building - COOT job with all the
inputs appropriately already selected.</p></li>
<li><p>Click “Run” and inspect the maps.</p></li>
<li><p>Find the ligand density HINT: “Validate” -&gt; “Unmodelled blobs…”</p></li>
<li><p>Rebuild (or delete) the sidechains pointing into the ligand density
HINT: Y67 and H73.</p></li>
<li><p>“File” -&gt; “Save to CCP4i2” when you’re done.</p></li>
<li><p>Close Coot and click the “REFMAC5” button at the bottom of the report
and run the Refinement – REFMAC5 task again – the job is
automatically filled with the correct inputs.</p></li>
</ol>
</section>
<section id="task-6-introduce-your-ligand-into-the-structure-manual-model-building-coot">
<h1 id="task-6-introduce-your-ligand-into-the-structure-manual-model-building-coot">Task 6: Introduce your ligand into the structure (Manual model building: COOT)<a class="headerlink" href="#task-6-introduce-your-ligand-into-the-structure-manual-model-building-coot" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>Click the “COOT” button at the bottom of the Refinement – REFMAC5
report.</p></li>
<li><p>All the correct inputs are automatically filled in but you need to
select the dictionary for the ligand you made earlier as the
“Geometry dictionary” in the “Additional data” subsection.</p></li>
<li><p>Click “Run”</p></li>
<li><p>Again find the large blob of difference electron density.</p></li>
<li><p>Summon coordinates for the ligand (Coot: “File” -&gt; “Get monomer…” and
provide the three letter code you gave to the drug).</p></li>
<li><p>Invite Coot to place the ligand into the electron density (“Ligand”
-&gt; “Find Ligands…”</p></li>
<li><p>Tick “Flexible?” and “DRG_from_dict” (or whatever you called the
ligand).</p></li>
<li><p>Click “Find Ligands”</p></li>
<li><p>Merge the positioned ligand into your main coordinates (“Edit” -&gt;
“Merge Molecules…”</p></li>
<li><p>Write updated coordinates into your CCP4i2 session (“File” -&gt; “Save
to CCP4i2” or “CCP4i2 extensions” -&gt; “Save to CCP4i2”</p></li>
<li><p>Run the Refinement – REFMAC5 task again and inspect the difference
density for your newly fitted ligand.</p></li>
</ol>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../../tutorials/alphafold/alphafold_tutorial.html" title="CCP4i2 MR Tutorial: Preparing AlphaFold/RoseTTAFold search models for MR. (Gamma example)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> CCP4i2 MR Tutorial: Preparing AlphaFold/RoseTTAFold search models for MR. (Gamma example) </span>
              </div>
            </a>
          
          
            <a href="../../tutorials/glyco/README.html" title="CCP4i2 Tutorial: Glyco (PDB:4IID)"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> CCP4i2 Tutorial: Glyco (PDB:4IID) </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>