
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Make Ligand Coordinate and Restraint Dictionaries with Acedrg &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Validate protein geometry (clipper)" href="../validate_protein/index.html" />
    <link rel="prev" title="Low Resolution Structure Refinement Pipeline" href="../lorestr_i2/index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#tasks/LidiaAcedrgNew/index" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Make Ligand Coordinate and Restraint Dictionaries with Acedrg </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">CCP4i2 Task Documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#tasks-lidiaacedrgnew-index--page-root" class="md-nav__link">Make Ligand Coordinate and Restraint Dictionaries with Acedrg</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input" class="md-nav__link">Input</a>
        </li>
        <li class="md-nav__item"><a href="#advanced-options" class="md-nav__link">Advanced options</a>
        </li>
        <li class="md-nav__item"><a href="#results" class="md-nav__link">Results</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/tasks/LidiaAcedrgNew/index.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="make-ligand-coordinate-and-restraint-dictionaries-with-acedrg">
<h1 id="tasks-lidiaacedrgnew-index--page-root">Make Ligand Coordinate and Restraint Dictionaries with Acedrg<a class="headerlink" href="#tasks-lidiaacedrgnew-index--page-root" title="Permalink to this heading">¶</a></h1>
<p>The <em>Make Ligand</em> task uses the program
<a class="reference external" href="https://www2.mrc-lmb.cam.ac.uk/groups/murshudov/content/acedrg/acedrg.html">ACEDRG</a>
to derive stereo-chemical information about monomers/ligands (or small
molecules). <em>ACEDRG</em> can derive “ideal” bond lengths, angles for an
unknown monomer/ligand. It also generates information about planar
groups and stereo-chemical properties in the monomer/ligand. The minumum
information Acedrg requires is element types of atoms in the
monomer/ligand, and the basic bonding pattern in the monomer/ligand,
such as atom connnections and bond-orders</p>
<section id="input">
<h2 id="input">Input<a class="headerlink" href="#input" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><figure class="align-default" id="id1">
<img alt="Figure 1: Main *Make Ligand* options" src="../../_images/input_1.png"/>
<figcaption>
<p><span class="caption-text">Figure 1: Main <em>Make Ligand</em> options</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><em>Make Ligand</em> accepts SMILES strings (either as a file or pasted
text) and MOL files as input. Also <em>Lidia: Coot’s Ligand Builder</em> can
be used to generate the input for <em>ACEDRG</em> The choice of input method
is selected using drop-down menu<strong>(1)</strong>.</p>
<p>If the menu is set to <em>“a MOL file”</em> or <em>“a SMILES file”</em>, then a
file of the appropriate type must be loaded/selected in the data
selector menu<strong>(2)</strong>.</p>
<p>If the menu is set to <em>“a SMILES string”</em>, then a text box is shown
into which a SMILES string may be typed/pasted<strong>(3)</strong>.</p>
<p>Clicking the <em>Run</em> button will then run <em>ACEDRG</em> with the <em>MOL</em> or
<em>SMILES</em> as input.
.. figure:: lidia.png</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">alt<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure 2:<em>Lidia</em></p>
</dd>
</dl>
<p>Figure 2:<em>Lidia</em></p>
</div></blockquote>
<p>If the menu is set to <em>“a sketch”</em>, then when the <em>“Run”</em> button is
pressed, the first thing that will happen is that <em>Lidia</em>(Figure 2)
will be launched. When <em>“a sketch”</em> is selected an option to provide
a starting point for the sketch is also shown. The starting point
input may be a <em>MOL</em> file or output from a previous <em>Make Ligand</em>
job. <em>Lidia</em> is a molecular sketcker provided by <em>COOT</em>. It allows
the user to create 2D (with stereo-isomer information) sketches of
molecules. The output of <em>Lidia</em> is subsequently passed to <em>ACEDRG</em>
by the <em>Make Ligand</em> task. In order for this to happen correctly, the
user <strong>must</strong> click <em>Apply</em><strong>(6)</strong> then <em>Close</em><strong>(7)</strong> when
finished sketching with <em>Lidia</em>.</p>
<p>The 3-letter code to be given to the monomer should be typed into
text box<strong>(4)</strong></p>
<figure class="align-default" id="id2">
<img alt="Figure 3: Main *Make Ligand* options with SMILES input box" src="../../_images/input_2.png"/>
<figcaption>
<p><span class="caption-text">Figure 3: Main <em>Make Ligand</em> options with SMILES input box</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Although <em>ACEDRG</em> attempts to name atoms sensibly, it is sometimes
desirable to try to match the atom names to those in a similar
structure. For instance, if the ligand to be generated contains a
large group of atoms in common with those of another ligand, it can
be useful to make sure the same atoms have the same names. This can
be done by changing the atom matching menu<strong>(5)</strong> from <em>nothing</em> to
either: <em>a specific 3-letter code</em>, in which case a text box appears
into which the 3-letter code of the existing reference ligand should
be typed; or <em>use dictionary</em> in which case a CCP4i2 <em>Geometry
dictionary</em> data selector appears - an existing dictionary in the
CCP4i2 database or dictionary file should supplied; or <em>all monomers</em>
in which case the whole CCP4/refmac5 monomer library is searched for
a matching group of atoms.</p>
</div></blockquote>
</section>
<section id="advanced-options">
<h2 id="advanced-options">Advanced options<a class="headerlink" href="#advanced-options" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><figure class="align-default" id="id3">
<img alt="Figure 4:*Advanced options*" src="../../_images/advanced.png"/>
<figcaption>
<p><span class="caption-text">Figure 4:<em>Advanced options</em></span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>This task has one advanced option - the number of random RDKIT
starting structures. The task will attempt to generate a sensible
geometric conformation of the generated ligand atoms, in addition to
the restraint dictionary. The RDKIT library is used to optimize the
geometry. In order to avoid finding a local minimum, several initial
arrangements of atoms are optimized; the optimized geometry with the
lowest energy of them all is accepted. The more initial conformations
are used, the more likely a better optimal geometry will be found.</p>
</div></blockquote>
</section>
<section id="results">
<h2 id="results">Results<a class="headerlink" href="#results" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><figure class="align-default" id="id4">
<img alt="Figure 5:*Report - 2D picture*" src="../../_images/report_1.png"/>
<figcaption>
<p><span class="caption-text">Figure 5:<em>Report - 2D picture</em></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The report is very simple and consists of 3 parts:</p>
<p>A 2D depiction of the generated ligand and the corresponding SMILES
string.</p>
<figure class="align-default" id="id5">
<img alt="Figure 6:*Report - 3D picture*" src="../../_images/report_2.png"/>
<figcaption>
<p><span class="caption-text">Figure 6:<em>Report - 3D picture</em></span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>A 3D representation of the optimized geometry</p>
<figure class="align-default" id="id6">
<img alt="Figure 7:*Report - Input and output files*" src="../../_images/report_3.png"/>
<figcaption>
<p><span class="caption-text">Figure 7:<em>Report - Input and output files</em></span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>A list of output data and any input data files.</p>
</div></blockquote>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../lorestr_i2/index.html" title="Low Resolution Structure Refinement Pipeline"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Low Resolution Structure Refinement Pipeline </span>
              </div>
            </a>
          
          
            <a href="../validate_protein/index.html" title="Validate protein geometry (clipper)"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Validate protein geometry (clipper) </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>