
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Symmetry determination details (program POINTLESS) &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Generate a Free R set" href="../freerflag/index.html" />
    <link rel="prev" title="Scaling and merging statistics (programs AIMLESS, PHASER, CTRUNCATE)" href="scaling_and_merging.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#tasks/aimless_pipe/symmetry" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Symmetry determination details (program POINTLESS) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">CCP4i2 Task Documentation</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Aimless data reduction pipeline</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#tasks-aimless-pipe-symmetry--page-root" class="md-nav__link">Symmetry determination details (program POINTLESS)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#automatic-determination-of-laue-group" class="md-nav__link">1. Automatic Determination of Laue group</a>
        </li>
        <li class="md-nav__item"><a href="#match-index-to-reference" class="md-nav__link">2. Match index to reference</a>
        </li>
        <li class="md-nav__item"><a href="#choose-known-or-previous-solution" class="md-nav__link">3. Choose known or previous solution</a>
        </li>
        <li class="md-nav__item"><a href="#no-symmetry-testing-just-copy-and-combine-input-files" class="md-nav__link">4. No symmetry testing just copy and combine input files</a>
        </li>
        <li class="md-nav__item"><a href="#footnote" class="md-nav__link">Footnote</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/tasks/aimless_pipe/symmetry.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <blockquote>
<div></div></blockquote>
<section id="symmetry-determination-details-program-pointless">
<h1 id="tasks-aimless-pipe-symmetry--page-root">Symmetry determination details (program POINTLESS)<a class="headerlink" href="#tasks-aimless-pipe-symmetry--page-root" title="Permalink to this heading">¶</a></h1>
<p>The indexing of the lattice in an integration program (such as Mosflm,
or the indexing and integration stages of XDS and DIALS)
is based on the lattice geometry, with no regard for the symmetry of the
diffraction pattern, which can only be determined after integration. The
default option here scores potential symmetry operators in the diffraction
pattern, and ranks the possible rotational groups (Laue group,
Patterson group or point group, see Footnote), and also
inspects axial reflections for possible systematic absences which may
indicate a likely space group. Be careful, the presence of
pseudo-symmetry may suggest a higher symmetry than the truth.
POINTLESS tries to allow for this possibility, but inspection of the scores for
individual symmetry elements may help to indicate the correct space
group in difficult cases (fig 3).
Conversely, severe radiation damage may obscure the true symmetry.
Weak high resolution data does not contain
reliable information for the determination of rotational symmetry (the
Laue or point group), so POINTLESS may cut the resolution just for this
purpose. If possible it cuts the data at the point where CC(½) falls
below 0.6 (calculated using only the Friedel symmetry (ie in P1)), or
I/σ(I)&gt;6 if there are insufficent data to calculate CC(½).</p>
<p>This first stage of the task has 4 options, with different result
reports:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#determine-laue-group-and-space-group">Determine Laue group and space group</a></p></li>
<li><p><a class="reference internal" href="#match-index-to-reference-data">Match index to reference data</a></p></li>
<li><p><a class="reference internal" href="#choose-a-known-or-previous-solution">Choose a known or previous solution</a></p></li>
<li><p><a class="reference internal" href="#no-symmetry-testing-just-copy-and-combine-input-files">No symmetry testing just copy and combine input files</a></p></li>
</ol>
<p><a class="reference external" href="./scaling_and_merging.html">Details of results of scaling and merging are shown on another
page</a></p>
<p><a class="reference external" href="./aimless_pipe.html">Back to main page</a></p>
<section id="automatic-determination-of-laue-group">
<span id="determine-laue-group-and-space-group"></span><h2 id="automatic-determination-of-laue-group">1. Automatic Determination of Laue group<a class="headerlink" href="#automatic-determination-of-laue-group" title="Permalink to this heading">¶</a></h2>
<figure class="align-default" id="id2">
<img alt="Figure 3: symmetry element scores" src="../../_images/aimless_pipe_report_3.png"/>
<figcaption>
<p><span class="caption-text">Figure 3: symmetry element scores</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><em>Scoring individual symmetry elements.</em> Each possible symmetry operator
in the lattice is scored separately, by a pairwise correlation
coefficient (CC) between E<sup>2</sup> for observations related by that
operator, and also by an R-factor, R<sub>meas</sub>. The CC is used to
estimate a probability, allowing for possible small samples by comparing
it with the distribution CCs of equal sized samples of unrelated
observation pairs. This separate scoring is useful in cases of
pseudo-symmetry to indicate the true symmetry, in cases where the
program gets it wrong. In the example in figure 3, the true symmetry is
C222, but because of the accidental combination of cell lengths, b ≈ √3
a, the lattice can be indexed as hexagonal. The scores show that three
orthogonal dyads are present, but the other potential operators of the
hexagonal lattice are absent.</p>
<figure class="align-default" id="id3">
<img alt="Figure 4: Laue group scores" src="../../_images/aimless_pipe_report_4.png"/>
<figcaption>
<p><span class="caption-text">Figure 4: Laue group scores</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><em>Scoring Laue groups.</em> The scores from the individual elements are then
combined into a joint score for all possible Laue groups which are
subgroups of the lattice group. A high score for a symmetry element
which is present in the lattice group but not in the Laue group will
count against that group (the CC-, Zc- and R- columns in the table).
Note that in Figure 4 the pseudo-hexagonal lattice can accommodate three
possible Cmmm settings, 60° apart: the one chosen randomly
by the original indexing (Reindex operator [h,k,l]) was wrong here.</p>
<figure class="align-default" id="id4">
<img alt="Figure 5: Systematic absences" src="../../_images/aimless_pipe_report_5.png"/>
<figcaption>
<p><span class="caption-text">Figure 5: Systematic absences</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><em>Systematic absence scores.</em> Within a chosen Laue group, space groups
(all chiral groups apart from the pairs I222 and
I2<sub>1</sub>2<sub>1</sub>2<sub>1</sub>, and I23 and I2<sub>1</sub>3) may
be distinguished by the presence or absence of screw axes along the cell
edges. A screw axis leads to systematic absences along an axis of the
reciprocal lattice eg a 2<sub>1</sub> screw along b in space group
P2<sub>1</sub> makes axial reflections 0k0 present only when k is even.
Detecting systematic absences may be unreliable because the axial
reflections may be few in number (as along the a axis in figure 5), or
missing from the dataset if they lie along the spindle rotation axis in
the data collection (in the blind region), or may be misleading if there
are approximate non-crystallographic screw axes (tNCS), but in many cases they
can suggest the space group, to be confirmed later: the space group
remains a hypothesis until the structure is satisfactorily solved. In
POINTLESS, a Fourier analysis is used to detect periodicity, on I’/σ:
the intensity I’ used here is adjusted by subtraction of a small
fraction (default 0.02) of the intensity of the neighbouring reflection
along the axis, to allow for possible overlap of a nearby strong
reflection (figure 5).</p>
<figure class="align-default" id="id5">
<img alt="Figure 6: Space group choice" src="../../_images/aimless_pipe_report_6.png"/>
<figcaption>
<p><span class="caption-text">Figure 6: Space group choice</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><em>Choice of space group or point group.</em> Possible space groups are
ranked according to their total probability = Laue group probability ×
Systematic absence probability. If there is a unique solution with the
highest total probability, this will be chosen as a “space group”
solution. If some of the potential systematic absence data is missing,
then more than one space group has the same score, and the space
group without translations
will be chosen, eg P 2, P 2 2 2, P 4 2 2, P 6 2 2 etc.
Enantiomorphic space groups will
have the same score, so the first one is chosen as a space group
solution (see figure 6), unless the other one matches that in the
input file. As well as the scores, a “confidence” score
is calculated for both the Laue group and the space group, defined as
√[Score × (Score - NextBestScore)]:
these values are printed in a
summary table as the Best Solution. If you prefer a different solution
to that chosen by the program, you can rerun the program with the
Choose a previous solution option.</div>
</div>
</section>
<section id="match-index-to-reference">
<span id="match-index-to-reference-data"></span><h2 id="match-index-to-reference">2. Match index to reference<a class="headerlink" href="#match-index-to-reference" title="Permalink to this heading">¶</a></h2>
<figure class="align-default" id="id6">
<img alt="Figure 7: alternative indexing scores" src="../../_images/aimless_pipe_report_7.png"/>
<figcaption>
<p><span class="caption-text">Figure 7: alternative indexing scores</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>In some point-groups there are more than one (typically two or four)
valid but non-equivalent indexing possibilities. For your first crystal,
you may choose any of these, but subsequent crystals must match the
first. This problem generally arises in cases where the point group
symmetry is less than the lattice symmetry: the alternative indexing
schemes are related by the symmetry operators present in the lattice but
not in the point group. These are the same point groups which may lead
to merohedral twinning, eg point group P3 has four possible indexing
schemes in the lattice point-group P622 (<a class="reference external" href="https://www.ccp4.ac.uk/html/reindexing.html">further
explanation</a>). Within
multiple datasets from the same crystal (eg MAD), you can avoid this
problem by only autoindexing one set, &amp; using the same indexing matrix
for the others, but different crystals must be explicitly checked for
consistent indexing. Reindexing ambiguities may also arise in
lower-symmetry point-groups in case of accidental coincidences or
relationships between cell dimensions (eg a ≈ b in orthorhombic or the
pseudo-hexagonal C222 example in figure 3).</p>
<div class="line-block">
<div class="line">A ranked table of scores for each possible indexing scheme is printed.
The example in figure 7 is unusually complicated: the true space group
is rhombohedral, R3, but the lattice is pseudo-cubic; in the
rhombohedral axis system (with a = b = c, α = β = γ) the angles are
close to 90°. This means that in addition to the usual ambiguity in R3
with alternative indexing [k,h,-l] (in the hexagonal setting aka H3
or R3:H) ,
there are four possible directions for true 3-fold axis, along the
body-diagonals of the cubic lattice, leading to a total of eight
possible indexing schemes.</div>
</div>
</section>
<section id="choose-known-or-previous-solution">
<span id="choose-a-known-or-previous-solution"></span><h2 id="choose-known-or-previous-solution">3. Choose known or previous solution<a class="headerlink" href="#choose-known-or-previous-solution" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">This option allows an explicit choice of indexing or symmetry. The
Choose solution from search options perform the usual search, but
selects the given solution even if it does not have the highest score.
The Specify Laue group name or Specify space group name use the given
groups without doing the searches, ie the program just changes the
group, with an option to reindex.</div>
</div>
</section>
<section id="no-symmetry-testing-just-copy-and-combine-input-files">
<span id="id1"></span><h2 id="no-symmetry-testing-just-copy-and-combine-input-files">4. No symmetry testing just copy and combine input files<a class="headerlink" href="#no-symmetry-testing-just-copy-and-combine-input-files" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">This option just sorts one or more input files, usually because there
are more than one, and you know the space group.</div>
</div>
</section>
<section id="footnote">
<h2 id="footnote">Footnote<a class="headerlink" href="#footnote" title="Permalink to this heading">¶</a></h2>
<p>Note that strictly a Laue group is the point group
symmetry of the diffraction pattern, ie the crystal point group plus a
centre of inversion at the origin of the reciprocal lattice: here we
include the lattice centring type (P, I, F, C, R) in the “Laue group”
definition, equivalent to the Patterson space group.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="scaling_and_merging.html" title="Scaling and merging statistics (programs AIMLESS, PHASER, CTRUNCATE)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Scaling and merging statistics (programs AIMLESS, PHASER, CTRUNCATE) </span>
              </div>
            </a>
          
          
            <a href="../freerflag/index.html" title="Generate a Free R set"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Generate a Free R set </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>