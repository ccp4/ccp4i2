
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Molecular replacement with fragments (Fragon) &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Calculate omit map" href="../comit/index.html" />
    <link rel="prev" title="Molecular Replacement with unconventional model – AMPLE" href="../ample/index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#tasks/fragon/index" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Molecular replacement with fragments (Fragon) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">CCP4i2 Task Documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#tasks-fragon-index--page-root" class="md-nav__link">Molecular replacement with fragments (Fragon)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input" class="md-nav__link">Input</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#basic-options" class="md-nav__link">Basic options</a>
        </li>
        <li class="md-nav__item"><a href="#advanced-options" class="md-nav__link">Advanced options</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#results" class="md-nav__link">Results</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#before-fragments-have-been-placed" class="md-nav__link">Before fragments have been placed</a>
        </li>
        <li class="md-nav__item"><a href="#once-fragments-have-been-placed" class="md-nav__link">Once fragments have been placed</a>
        </li>
        <li class="md-nav__item"><a href="#final-results" class="md-nav__link">Final results</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/tasks/fragon/index.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="molecular-replacement-with-fragments-fragon">
<h1 id="tasks-fragon-index--page-root">Molecular replacement with fragments (Fragon)<a class="headerlink" href="#tasks-fragon-index--page-root" title="Permalink to this heading">¶</a></h1>
<blockquote>
<div><p>The Fragon task uses the program Phaser to place fragments of
secondary structure such as ideal alpha helices or ensembles of beta
strands. These fragments are likely to be highly similar to some
regions of the target structure but will only correspond to a tiny
fraction of the protein. Hence the signal to noise ratio will be very
low. This means that the log-likelihood gain scoring used in Phaser
will enrich the solution list with correctly placed fragments but
will not be sufficient to discriminate correct from incorrect
placements. Therefore, attempts are made to improved the poor
starting phases calculated from each placed fragment by density
modification with ACORN. If the phases improve sufficiently
(monitored by a correlation coefficient) the the improved phases can
be used for automated model building</p>
</div></blockquote>
<section id="input">
<h2 id="input">Input<a class="headerlink" href="#input" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p><img alt="image1" src="../../_images/fragon_task_1.png"/></p>
<p>First the experimental data must be selected <strong>(1)</strong>. A set of
observations is required.</p>
<p>The composition of the asymmetric unit must be defined <strong>(2)</strong> in one
of two ways. Ideally you should provide the contents of the
crystallographic asymmetric unit. This should have been entered in
the Define AU contents task but can be entered here by clicking the
“Specify AU contents” button and selecting one or more sequence
file(s). Alternatively you can enter the estimated solvent content of
the crystal.</p>
<p>There are three choices for the fragment to search with <strong>(3)</strong>.
Firstly, you can select an ideal poly-alanine helix of between 5 and
20 residues. Secondary structure prediction may help guide your
choice but in general a few runs with lengths of 10, 12 and 14
residues is a good starting point.</p>
<p>Secondly, you can choose ensembles of single beta strands with
between 3 and 5 residues or from a number of ensembles of pairs of
parallel and antiparallel 5 residue ideal beta strands with varying
angles between the strands.</p>
<p>Thirdly, you can input your own choice of starting fragment. Any
model that works in Phaser is suitable.</p>
<p>Next you need to choose the number of copies of the fragment to
search for <strong>(4)</strong>. In general, unless you are certain that your
structure contains multiple (straight) helices, one or two copies is
a good starting point. If you know there are multiple copies of the
protein in the asymmetric unit then search for that number of copies
of the fragment. Although there are limits to the size that the
search tree can grow to in Phaser, searching for multiple copies when
the signal to noise does not increase as subsequent fragments are
placed will result in very long Phaser run times.</p>
</div></blockquote>
<section id="basic-options">
<h3 id="basic-options">Basic options<a class="headerlink" href="#basic-options" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p><img alt="image2" src="../../_images/fragon_task_2.png"/>
You can specify the maximum number of potential Phaser solutions to
test <strong>(1)</strong>. Unless you select the option to test all solutions
<strong>(2)</strong>, Fragon will stop once a solution with a correlation
coefficient (CC) from density modification above the value specified
here <strong>(3)</strong> is found.</p>
<p>The Phaser search uses OpenMP parallelisation and multiple potential
solutions can be tested with density modification in parallel. Set
the number of CPUs to use here <strong>(4)</strong>. If you have access to a
multi-CPU machine with lots (&gt;8) of cores it is probably most
efficient to run several Fragon tasks searching for different
fragments as the OpenMP speed-up of Phaser (usually the slowest step)
decreases above about 8 parallel threads.</p>
<p>Finally you can choose to search alternative space groups, the input
space group only or, when relevant, both hands of enantiomorphic
space groups (the default) <strong>(5)</strong>.</p>
</div></blockquote>
</section>
<section id="advanced-options">
<h3 id="advanced-options">Advanced options<a class="headerlink" href="#advanced-options" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p><img alt="image3" src="../../_images/fragon_task_3.png"/>
The default options for all of these parameters have been
successfully used on several large test-sets so changing them is not
advised unless you have exhaustively tried different search models.</p>
<p>One option you may wish to adjust is the purging of solutions between
successive fragment searches <strong>(1)</strong>. The fewer partial solutions
carried forward, the faster the Phaser run. However, when there are
multiple partial solutions this means that the previous search did
not find a clear solution so pruning too aggressively may lead to
failure. 100 potential solutions seems a good compromise and has been
well tested.</p>
<p>If Phaser detects translational non-crystallographic symmetry (tNCS)
and the search fails you may want to try again with this <strong>(2)</strong>
option selected.</p>
<p>You can alter more parameters in the Phaser search by selecting this
<strong>(3)</strong> option. No further help is given as if you think you need to
alter these options you will know what they do.</p>
<p><img alt="image4" src="../../_images/fragon_task_4.png"/></p>
<p>When searching with one of the supplied ensembles of beta strands by
default the pair of strands is refined as a single rigid-body. You
can choose <strong>(4)</strong> to further rigid-body refine each strand
separately or split the strands in half around the central C-alpha of
the strands and refine each half separately.</p>
</div></blockquote>
</section>
</section>
<section id="results">
<h2 id="results">Results<a class="headerlink" href="#results" title="Permalink to this heading">¶</a></h2>
<section id="before-fragments-have-been-placed">
<h3 id="before-fragments-have-been-placed">Before fragments have been placed<a class="headerlink" href="#before-fragments-have-been-placed" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p><img alt="image5" src="../../_images/fragon_report_1.png"/>
Whilst Phaser is running to place the fragment(s), the report will
look like this. The current Phaser stage is shown here <strong>(1)</strong>.
Depending on how easily Phaser is able to place the fragments this
stage may take a while.</p>
</div></blockquote>
</section>
<section id="once-fragments-have-been-placed">
<h3 id="once-fragments-have-been-placed">Once fragments have been placed<a class="headerlink" href="#once-fragments-have-been-placed" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p><img alt="image6" src="../../_images/fragon_report_2.png"/>
When Phaser has placed the fragments. The report will look like
this. The number of solutions found by Phaser and the
log-likelihood gain (LLG) and translation-function Z-score (TF
Z-score) for the top solution are reported <strong>(1)</strong>. If Phaser
found more solutions than requested only the solutions up to the
number requested will be tested with density modification with
ACORN <strong>(2)</strong>. This table <strong>(3)</strong> lists the LLG and TF Z-score for
these solutions. As the results of density modification with ACORN
are obtained this table shows which solutions are currently being
tested and will update with the correlation coefficient (CC) from
density modification.</p>
</div></blockquote>
</section>
<section id="final-results">
<h3 id="final-results">Final results<a class="headerlink" href="#final-results" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p><img alt="image7" src="../../_images/fragon_report_3.png"/></p>
<p>Once all the solutions have been tested, or a solution with a
correlation coefficient (CC) from density modification above the
value specified has been found, Fragon will stop. The best CC
<strong>(1)</strong> and if the value suggests the phases will be sufficiently
good for automated model building <strong>(2)</strong> is reported.</p>
<p>The output data for the best scoring solution comprise: The
coordinates for the placed fragment <strong>(3)</strong>, the phases after
density modification <strong>(4)</strong> and map-coefficients suitable for
viewing in Coot <strong>(5)</strong>.</p>
<p>Follow-on tasks include manual model building <strong>(6)</strong> - usually to
inspect the quality of the map - and automated model building
<strong>(7)</strong> .</p>
</div></blockquote>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../ample/index.html" title="Molecular Replacement with unconventional model – AMPLE"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Molecular Replacement with unconventional model – AMPLE </span>
              </div>
            </a>
          
          
            <a href="../comit/index.html" title="Calculate omit map"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Calculate omit map </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>