
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Non-programming requirements for implementing CCP4i2 tasks &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CCP4I2 Developers: Demo data for tutorials" href="demo_data.html" />
    <link rel="prev" title="CCP4I2 Generating Reports" href="reports.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#developers/extras" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Non-programming requirements for implementing CCP4i2 tasks </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Developer Notes</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#developers-extras--page-root" class="md-nav__link">Non-programming requirements for implementing CCP4i2 tasks</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#supporting-what-next" class="md-nav__link">Supporting ‘What next?’</a>
        </li>
        <li class="md-nav__item"><a href="#bibliographic-references" class="md-nav__link">Bibliographic References</a>
        </li>
        <li class="md-nav__item"><a href="#task-documentation" class="md-nav__link">Task documentation</a>
        </li>
        <li class="md-nav__item"><a href="#creating-documentation-images" class="md-nav__link">Creating documentation images</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/developers/extras.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="non-programming-requirements-for-implementing-ccp4i2-tasks">
<h1 id="developers-extras--page-root">Non-programming requirements for implementing CCP4i2 tasks<a class="headerlink" href="#developers-extras--page-root" title="Permalink to this heading">¶</a></h1>
<section id="supporting-what-next">
<h2 id="supporting-what-next">Supporting ‘What next?’<a class="headerlink" href="#supporting-what-next" title="Permalink to this heading">¶</a></h2>
<p>After each job the GUI presents the user with a list of reasonable tasks
to perform next and a web page with more discussion of the options. It
is the responsibility of the task author to provide the information for
these facilities. Note that if the user opts to follow from a sub-job in
a pipeline then it is the parent pipeline that is queried to provide the
‘what next’ information.</p>
<p>There are two mechanisms to provide the information; the simplest is as
a WHATNEXT attribute of either the wrapper class (CPluginScript) or gui
class (CTaskWidget). So, for example, for buccaneer the WHATNEXT is set
as a list of names of tasks..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CTaskBuccaneer</span><span class="p">(</span><span class="n">CCP4TaskWidget</span><span class="o">.</span><span class="n">CTaskWidget</span><span class="p">):</span>
  <span class="n">TASKNAME</span> <span class="o">=</span> <span class="s1">'buccaneer'</span>
  <span class="o">...</span>
  <span class="n">WHATNEXT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'refmac_simple'</span><span class="p">]</span>
</pre></div>
</div>
<p>The more flexible approach is to have a function whatNext() in either
the wrapper module or the gui module (note it is a function and not a
member of the class). This is passed four arguments:</p>
<table>
<tbody>
<tr class="row-odd"><td><p>jobId</p></td>
<td><p>The jobId of the job (or the jobId of the parent
pipeline job if a sub-job is selected)</p></td>
</tr>
<tr class="row-even"><td><p>taskName</p></td>
<td><p>The taskname of the job (or of the sub-job if a
sub-job was selected)</p></td>
</tr>
<tr class="row-odd"><td><p>childJobNumber</p></td>
<td><p>The job number of the sub-job if a sub-job was
selected</p></td>
</tr>
<tr class="row-even"><td><p>projectName</p></td>
<td><p>The project name</p></td>
</tr>
</tbody>
</table>
<p>This function should return either a list of tasks that can be run next
or a list of task name and text to appear on the GUI. For example for
buccaneer_build_refine:</p>
<p>The WHATNEXT parameter or the return from <em>whatNext()</em> is normally
expected to be a list of tasknames but the list item could be a list
containing two items: the taskname and the filepath of a params file
that provides default parameters to the next task. The params file path
should be of the form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CCP4I2/pipelines/bucref_mr/scripts/bucref_after_experimental.params.xml
</pre></div>
</div>
<p>i.e. the file is expected to be found somewhere in the CCP4I2 directory.
The <em>bucref_after_experimental.params.xml</em> is used to set one input
parameter in the <em>Autobuild protein</em> gui so that it expects input from
experimental phasing.</p>
<p>In principle this mechanism could be used to pick up a project or
task-specific file if the <em>whatNext()</em> function returns a list including
a reference to a file in the current project directory of the form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$PROJECT/CCP4_JOBS/job_5/for_whatever_next_task.params.xml
</pre></div>
</div>
<p>This is interpreted in the context of the project viewer that
understands $PROJECT to mean the current project directory. (Note this
is not tested.) It is the responsibility of either the wrapper or the
function to provide the params file in the project directory.</p>
<p>Each task should provide a web page with discussion of what to do next.
This should be $CCP4I2/docs/whatnext/<em>taskName</em>.html.</p>
</section>
<section id="bibliographic-references">
<h2 id="bibliographic-references">Bibliographic References<a class="headerlink" href="#bibliographic-references" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">Task reports will normally include a section of bibliographic
references for software used by the task. This is presented as text
with options to link to the original paper (if available on-line) and
to download the reference in either MedLine (suitable for EndNote) or
BibTeX format. The task implementer must provide two files containing
the references in the appropriate formats. These files should be
called <em>wrappers/mytask/script/mytask.medline.txt</em> and
<em>wrappers/mytask/script/mytask.bibtex.txt</em>. The first can be created
and downloaded from the PubMed site:</div>
<div class="line"><a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/advanced">http://www.ncbi.nlm.nih.gov/pubmed/advanced</a></div>
<div class="line">After selecting the references use the <em>Send to</em> tool at the top left
of the page to create a file in MEDLINE format. To get the BibTeX file
input the PUbMed Ids (PMIDs) (or other suitable search query) here:</div>
<div class="line"><a class="reference external" href="http://www.bioinformatics.org/texmed/">http://www.bioinformatics.org/texmed/</a></div>
</div>
<p>The MedLine file is used by CCP4i2 to generate the information in the
report and if a copy of the paper is available online the MedLine entry
should be edited to append the a line such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ncbi</span><span class="o">.</span><span class="n">nlm</span><span class="o">.</span><span class="n">nih</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pmc</span><span class="o">/</span><span class="n">articles</span><span class="o">/</span><span class="n">PMC3069738</span><span class="o">/</span>
</pre></div>
</div>
<p>If there are multiple references then the first in the file will be
treated as the one for which citation is preferred.</p>
<p>Note that the ‘MEDLINE’ format file can be imported into <em>EndNote</em> as
<em>PubMed(NLM)</em> format (found in the <em>Other filters</em> menu of the <em>Import</em>
tool.</p>
<div class="line-block">
<div class="line">These references are accessed from three places in the gui:</div>
<div class="line">References for the current task can be accessed from the <em>Help</em> menu
in the project viewer. These references are autogenerated from the
contents of the <em>medline</em> file for the task and recursively for
sub-tasks that are specified by the script’s SUBTASKS parameter.</div>
<div class="line">References are also automatically generated and appended to a job
report. But if the tasks used by a pipeline are only determined at
run-time then it may be worthwhile specifying references in the report
explicitly see <a class="reference external" href="./reports.html#references">here</a>.</div>
<div class="line">PLACEHOLDER - not yet implemented: autogenerated for all tasks used in
determining a data file seelcted by the user.</div>
</div>
</section>
<section id="task-documentation">
<h2 id="task-documentation">Task documentation<a class="headerlink" href="#task-documentation" title="Permalink to this heading">¶</a></h2>
<p>Each task should have a page of documentation named
$CCP4I2/docs/tasks/<em>taskName</em>/index.html and any images or other
material for the page should be in the same directory. There is a
template html file: <em>ccp4i2/docs/tasks/resources/template.html</em>. See the
<em>parrot</em> documentation for example of required style.</p>
<p>In order to support installation of third party created pipelines with
all resources in one directory the task documentation can as be in
$CCP4I2/pipelines/<em>taskName</em>/docs/index.html.</p>
</section>
<section id="creating-documentation-images">
<h2 id="creating-documentation-images">Creating documentation images<a class="headerlink" href="#creating-documentation-images" title="Permalink to this heading">¶</a></h2>
<p>There is a customised screen grab tool in the <em>Developer tools</em> sub-menu
of the <em>Utilities</em> menu. The tool will grab either the task input frame
or report as it appears in the Project viewer. You can resize the window
and use the scroll bar to set up the required frame size. Beware with
the task input you should resize the window to eliminate any space below
the input widgets and for reports try to keep all screenshots the same
width for a neater presentation in the web page.</p>
<div class="line-block">
<div class="line">For the first screenshot of a new task you will be prompted to select
a directory to contain the screenshots and these will be automatically
named:</div>
<div class="line"><em>directory/taskname_</em>task<em>_1.png</em> or</div>
<div class="line"><em>directory/taskname_</em>report<em>_1.png</em> etc.</div>
</div>
<p>To standardise documentation screenshot appearance please use the images
of numbers in <em>ccp4i2/docs/resources</em>. One way to add these to the
screenshot is using <em>Inkscape</em>: open the screenshot image then use
<em>File-&gt;Import</em> to import each label <em>svg</em> file and then drag the label
to correct place. Save by using the <em>File-&gt;Export PNG image</em>.</p>
<p>Last modified: Fri Oct 2 15:01:56 BST 2015</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="reports.html" title="CCP4I2 Generating Reports"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> CCP4I2 Generating Reports </span>
              </div>
            </a>
          
          
            <a href="demo_data.html" title="CCP4I2 Developers: Demo data for tutorials"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> CCP4I2 Developers: Demo data for tutorials </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>