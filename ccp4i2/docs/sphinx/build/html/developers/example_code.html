
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#00020a">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Example Code for CData Classes &#8212; CCP4i2  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="https://github.com/bwithd/sphinx-material/blob/main/sphinx_material/sphinx_material/static/stylesheets/application.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#005BBB data-md-color-accent=yellow>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#developers/example_code" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="CCP4i2  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">CCP4i2  documentation</span>
          <span class="md-header-nav__topic"> Example Code for CData Classes </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">CCP4i2  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="CCP4i2 documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="CCP4i2 documentation">CCP4i2  documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://gitlab.com/ccp4i2/rstdocs" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    
  </div>
</a>
    </div>
  
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#developers-example-code--page-root" class="md-nav__link">Example Code for <em>CData</em> Classes</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#getting-setting-data" class="md-nav__link">Getting/Setting Data</a>
        </li>
        <li class="md-nav__item"><a href="#qualifiers" class="md-nav__link">Qualifiers</a>
        </li>
        <li class="md-nav__item"><a href="#maths" class="md-nav__link">Maths</a>
        </li>
        <li class="md-nav__item"><a href="#cdatafile" class="md-nav__link">CDataFile</a>
        </li>
        <li class="md-nav__item"><a href="#ci2xmlfile-xml-files" class="md-nav__link">CI2XmlFile - XML Files</a>
        </li>
        <li class="md-nav__item"><a href="#lists" class="md-nav__link">Lists</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/developers/example_code.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="example-code-for-cdata-classes">
<h1 id="developers-example-code--page-root">Example Code for <em>CData</em> Classes<a class="headerlink" href="#developers-example-code--page-root" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Use the <a class="reference external" href="./introduction.html#console">console mode</a> to try these. I
expect that plugins will mostly initialise data structures from DEF and
DATA files so you will not need to do this basic initialisation stuff
often. Please ask if you need explanation or other examples or feel free
to edit in more examples.</p>
</section>
<section id="getting-setting-data">
<h2 id="getting-setting-data">Getting/Setting Data<a class="headerlink" href="#getting-setting-data" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>from core.CCP4Data import *
i = CInt(5)
print type(i),i        &gt;&gt;&gt;&gt;&gt;   &lt;class 'CCP4Data.CInt'&gt; 5
i.set(7)
print type(i),i        &gt;&gt;&gt;&gt;&gt;   &lt;class 'CCP4Data.CInt'&gt; 7
i = 7
print type(i),i        &gt;&gt;&gt;&gt;&gt;   &lt;type 'int'&gt; 7     (Beware!!!)

# A 'complex' class with two items - several equivalent ways to initialise..
r = CFloatRange(start=5,end=10)
r = CFloatRange(value={'start':5,'end':10})
r = CFloatRange(name='foo',value={'start':5,'end':10})
print type(r),r        &gt;&gt;&gt;&gt;&gt;   &lt;class 'CCP4Data.CFloatRange'&gt; {'start': 5.0, 'end': 10.0}

# addressing the individual items
r = CFloatRange()
r.start= 5.0
r.end = 10.0
print type(r.start),r.start         &gt;&gt;&gt;&gt;&gt;  &lt;class 'CCP4Data.CFloat'&gt; 5.0

# When you need getattr (or setattr)
for item in ['start','end']:
  sum = sum  + getattr(r,item)
</pre></div>
</div>
</section>
<section id="qualifiers">
<h2 id="qualifiers">Qualifiers<a class="headerlink" href="#qualifiers" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">CInt</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">i</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>             <span class="o">&gt;&gt;&gt;&gt;&gt;</span>  <span class="s1">'below minimum'</span> <span class="n">exception</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">CFloatRange</span><span class="p">(</span><span class="n">start_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">end_max</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">compare</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># Note setting qualifiers for items</span>
<span class="n">r</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">r</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="mf">2.0</span>          <span class="o">&gt;&gt;&gt;&gt;&gt;</span> <span class="s1">'End of range less than start'</span> <span class="n">exception</span>
<span class="n">r</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="mf">12.0</span>         <span class="o">&gt;&gt;&gt;&gt;&gt;</span> <span class="s1">'above maximum'</span> <span class="n">exception</span>
<span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>              <span class="o">&gt;&gt;&gt;&gt;&gt;</span>  <span class="p">{</span> <span class="s1">'start'</span> <span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s1">'end'</span> <span class="p">:</span> <span class="kc">None</span> <span class="p">}</span>


<span class="c1"># List all qualifers</span>
<span class="n">r</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">()</span>       <span class="o">&gt;&gt;&gt;&gt;&gt;</span>  <span class="p">{</span><span class="s1">'compare'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">()</span> <span class="o">&gt;&gt;&gt;&gt;&gt;</span>   <span class="p">{</span><span class="s1">'charWidth'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'min'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">'default'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'allowUndefined'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'onlyEnumerators'</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">'enumerators'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'menuText'</span><span class="p">:</span> <span class="p">[]}</span>
<span class="c1"># List qualifiers but not those that have default values</span>
<span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="o">&gt;&gt;&gt;&gt;</span> <span class="p">{</span><span class="s1">'min'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span class="c1"># Get a specific qualifier</span>
<span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">qualifier</span><span class="p">(</span><span class="s1">'min'</span><span class="p">)</span>   <span class="o">&gt;&gt;&gt;&gt;&gt;</span>    <span class="mf">0.0</span>
</pre></div>
</div>
</section>
<section id="maths">
<h2 id="maths">Maths<a class="headerlink" href="#maths" title="Permalink to this heading">¶</a></h2>
<p>NOTE: The CData classes do a lot of work validating after ever value
update. So probably not wise to use them for serious calculations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">s</span>    <span class="o">&gt;&gt;&gt;&gt;</span>  <span class="mf">5.0</span>  <span class="mf">9.0</span>

<span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">r</span>                  <span class="o">&gt;&gt;&gt;&gt;&gt;</span>  <span class="p">{</span><span class="s1">'start'</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">'end'</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

<span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="o">&gt;</span><span class="mi">3</span>                <span class="o">&gt;&gt;&gt;&gt;&gt;</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="cdatafile">
<h2 id="cdatafile">CDataFile<a class="headerlink" href="#cdatafile" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">Initialising and retrieving a file name. Applies to subclasses such as
CPdbDataFile and CMtzDataFile</div>
<div class="line">There is a project ‘my_project’ with directory
/Users/lizp/Desktop/myproject.</div>
<div class="line">N.B. CDataFile.__str__() is best way to return a string with full file
name. e.g. <em>str(f)</em></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">core.CCP4File</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CDataFile</span><span class="p">(</span><span class="s1">'/Users/lizp/Desktop/whatsit.wht'</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">f</span>                 <span class="o">&gt;&gt;&gt;&gt;&gt;</span>   <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">lizp</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">whatsit</span><span class="o">.</span><span class="n">wht</span>
<span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>                  <span class="o">&gt;&gt;&gt;&gt;&gt;</span>   <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">lizp</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">whatsit</span><span class="o">.</span><span class="n">wht</span>
<span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>                 <span class="o">&gt;&gt;&gt;&gt;&gt;</span>   <span class="p">{</span><span class="s1">'project'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'baseName'</span><span class="p">:</span> <span class="s1">'whatsit.wht'</span><span class="p">,</span> <span class="s1">'relPath'</span><span class="p">:</span> <span class="s1">'/Users/lizp/Desktop'</span><span class="p">}</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CDataFile</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">'my_project'</span><span class="p">,</span><span class="n">relPath</span><span class="o">=</span><span class="s1">'job_2'</span><span class="p">,</span><span class="n">baseName</span><span class="o">=</span><span class="s1">'whatsit.wht'</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>                  <span class="o">&gt;&gt;&gt;&gt;&gt;</span>    <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">lizp</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">job_2</span><span class="o">/</span><span class="n">whatsit</span><span class="o">.</span><span class="n">wht</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CDataFile</span><span class="p">(</span><span class="s1">'/Users/lizp/Desktop/myproject/job_2/whatsit.wht'</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>                 <span class="o">&gt;&gt;&gt;&gt;&gt;</span>    <span class="p">{</span><span class="s1">'project'</span><span class="p">:</span> <span class="s1">'my_project'</span><span class="p">,</span> <span class="s1">'baseName'</span><span class="p">:</span> <span class="s1">'whatsit.wht'</span><span class="p">,</span> <span class="s1">'relPath'</span><span class="p">:</span> <span class="s1">'job_2'</span><span class="p">}</span>
<span class="n">f</span><span class="o">.</span><span class="n">relPath</span> <span class="o">=</span> <span class="s1">'job_66'</span>
<span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>                 <span class="o">&gt;&gt;&gt;&gt;&gt;</span>    <span class="p">{</span><span class="s1">'project'</span><span class="p">:</span> <span class="s1">'my_project'</span><span class="p">,</span> <span class="s1">'baseName'</span><span class="p">:</span> <span class="s1">'whatsit.wht'</span><span class="p">,</span> <span class="s1">'relPath'</span><span class="p">:</span> <span class="s1">'job_66'</span><span class="p">}</span>
</pre></div>
</div>
<p>Note that <em>CDataFile.dbFileId</em> is an integer id for the file in the
database and is vital for the core i2 code that saves the file
provenance to the database. If you are copying filenames in pipelines
(for example setting the input to one wrapper from the output of
another) please copy the whole of the CDataFile object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">secondPlugin</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">inputData</span><span class="o">.</span><span class="n">XYZIN</span> <span class="o">=</span> <span class="n">firstPlugin</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">outputData</span><span class="o">.</span><span class="n">XYZOUT</span>
</pre></div>
</div>
<p>Here, in a pipeline, <em>firstPlugin</em> and <em>secondPlugin</em> are two
consecutive wrappers and <em>XYZOUT</em> and <em>XYZIN</em> are instances of
<em>CPdbDataFile</em> that are the output and input of the two plugins. This is
explained in the <a class="reference external" href="./pipleines.html">pipelines</a> section.</p>
</section>
<section id="ci2xmlfile-xml-files">
<h2 id="ci2xmlfile-xml-files">CI2XmlFile - XML Files<a class="headerlink" href="#ci2xmlfile-xml-files" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">Reading an XML file. Note that the ‘CCP4I2’ directory alias can be
used as ‘project’</div>
<div class="line">The body of the file can be return as an etree which can be addressed
using the functions from lxml</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">core.CCP4File</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">CI2XmlDataFile</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">'CCP4I2'</span><span class="p">,</span><span class="n">relPath</span><span class="o">=</span><span class="s1">'test/data'</span><span class="p">,</span><span class="n">baseName</span><span class="o">=</span><span class="s1">'pdbset.def.xml'</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>           <span class="o">&gt;&gt;&gt;&gt;&gt;</span>  <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span> <span class="s1">'DEF'</span><span class="p">,</span> <span class="s1">'comment'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'creationTime'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                 <span class="s1">'userId'</span><span class="p">:</span> <span class="s1">'lizp'</span><span class="p">,</span> <span class="s1">'ccp4iVersion'</span><span class="p">:</span> <span class="s1">'0.1'</span><span class="p">,</span> <span class="s1">'jobId'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                 <span class="s1">'project'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'pluginName'</span><span class="p">:</span> <span class="s1">'pdbset'</span><span class="p">,</span>
                                 <span class="s1">'pluginVersion'</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'pluginTitle'</span><span class="p">:</span> <span class="s1">'PDBSet'</span><span class="p">}</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">getBodyEtree</span><span class="p">()</span>
<span class="c1"># Use lxml functionality to address the body of the xml file..</span>
<span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>  <span class="nb">print</span> <span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>     <span class="o">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>   <span class="n">inputData</span>
                                                          <span class="n">outputData</span>
                                                          <span class="n">controlParameters</span>
</pre></div>
</div>
<p>Creating an XML file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">core.CCP4File</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CI2XmlDataFile</span> <span class="p">(</span><span class="s1">'/Users/lizp/Desktop/whatsit.xml'</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">()</span>    <span class="c1">#  Sets the current time and user in header</span>
<span class="n">f</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="s1">'DEF'</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">'mystuff'</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">'something'</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">'something_else'</span><span class="p">))</span>

<span class="n">f</span><span class="o">.</span><span class="n">saveFile</span><span class="p">(</span><span class="n">bodyEtree</span><span class="o">=</span><span class="n">tree</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="lists">
<h2 id="lists">Lists<a class="headerlink" href="#lists" title="Permalink to this heading">¶</a></h2>
<p>The list base class <em>CList</em> is intended to behave like a Python list but
has the restriction that all items in the list must be of the same type
and that type is a subclass of <em>CData</em>. The CList has qualifiers
<em>listMinLength</em> and <em>listMaxLength</em> which do what they say and
<em>listCompare</em> which is an integer - if it is defined with value 1/-1
then each item in the list must be greater/less than preceeding item -
for this to work the list item class must have a __cmp__() method (<a class="reference external" href="http://docs.python.org/library/functions.html#cmp">see
Python docs</a>). In
the example below a list of integers with minimum length 1 and minimum
integer value 1 is created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">core.CCP4Data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">CList</span><span class="p">(</span><span class="n">subItem</span><span class="o">=</span> <span class="p">{</span> <span class="s1">'class'</span> <span class="p">:</span> <span class="n">CInt</span><span class="p">,</span> <span class="s1">'qualifiers'</span> <span class="p">:</span> <span class="p">{</span> <span class="s1">'min'</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s1">'default'</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}},</span> <span class="n">listMinLength</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">l</span> <span class="o">&gt;&gt;&gt;&gt;</span>  <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">l</span> <span class="o">&gt;&gt;&gt;&gt;</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="o">&gt;&gt;&gt;&gt;</span> <span class="n">below</span> <span class="n">minimum</span> <span class="n">error</span>
<span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="nb">print</span> <span class="n">l</span>  <span class="o">&gt;&gt;&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;&gt;&gt;</span> <span class="nb">list</span> <span class="n">below</span> <span class="n">minimum</span> <span class="n">length</span> <span class="n">error</span>
</pre></div>
</div>
<p>Below is an example of a <em>CList</em> subclass from the <em>CCP4ModelData</em> -
this has list items <em>CResidueRange</em> that has components: chainId and
first and last residue.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">core.CCP4ModelData</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">CResidueRangeList</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'chainId'</span><span class="p">:</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'firstRes'</span><span class="p">:</span><span class="s1">'23'</span><span class="p">,</span><span class="s1">'lastRes'</span><span class="p">:</span><span class="s1">'45'</span><span class="p">})</span>
<span class="nb">print</span> <span class="n">l</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>   <span class="o">&gt;&gt;&gt;&gt;</span> <span class="p">[{</span><span class="s1">'firstRes'</span><span class="p">:</span> <span class="s1">'23'</span><span class="p">,</span> <span class="s1">'chainId'</span><span class="p">:</span> <span class="s1">'A'</span><span class="p">,</span> <span class="s1">'lastRes'</span><span class="p">:</span> <span class="s1">'45'</span><span class="p">}]</span> <span class="p">,</span>
<span class="nb">print</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">chainId</span>  <span class="o">&gt;&gt;&gt;&gt;</span> <span class="n">A</span>
</pre></div>
</div>
<hr class="docutils"/>
<p>Last modified: Thu Jun 14 13:03:14 BST 2012</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, CCP4.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.2.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>